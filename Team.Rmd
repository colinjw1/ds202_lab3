---
title: "Team"
author: "Colin Willenborg, Allan Juarez, Adam Brandt"
date: "9/23/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
dat <- readxl::read_xls('./GSS.xls')
dat <- dat %>%
  rename(
    Year = 'Gss year for this respondent',
    Happiness = 'General happiness',
    Religion = 'Religion in which raised',
    Political.Party = 'Political party affiliation',
    Sex = 'Respondents sex',
    Degree = 'Rs highest degree',
    Year.School = 'Highest year of school completed',
    Children = 'Number of children',
    Marital.Status = 'Marital status',
    Self.Emp = 'R self-emp or works for somebody',
    ID = 'Respondent id number',
    Ballot = 'Ballot used for interview'
  )
dat$Children <- as.numeric(dat$Children)
dat$Year.School <- as.numeric(dat$Year.School)
```

## Question 1
##allan 
```{r}
education <- dat[c('Political party affiliation','Highest year of school completed')]  

education <- filter(education, education$'Highest year of school completed' != 'No answer')
education <- filter(education, education$'Highest year of school completed' != "Don't know")
education$'Highest year of school completed' <- as.numeric(education$'Highest year of school completed')

education <- aggregate(education$'Highest year of school completed',list(education$'Political party affiliation'), FUN = mean)
education <- education %>% rename(party = Group.1, years = x)
 
ggplot(education, aes(x=party, y=years)) + geom_bar(stat = "identity")+coord_flip()
```

1. Looking at the average years of school for every party. YOu can see that there are about three types of the two parties. Strong, Not Str, INd, in every category republicans average more years of school than democrats. The lowest average of years in school tended to not know their affiliation.

##colin

## Question 2
##allan 
```{r}
second <-dat

education <- dat[c('Political party affiliation','Highest year of school completed')] 
education <- filter(education, education$'Highest year of school completed' != 'No answer')
education <- filter(education, education$'Highest year of school completed' != "Don't know")
education$'Highest year of school completed' <- as.numeric(education$'Highest year of school completed') 
education <- aggregate(education$'Highest year of school completed',list(education$'Political party affiliation'), FUN = median)
education
second <- filter(second, second$'Highest year of school completed' != 'No answer')
second <- filter(second, second$'Highest year of school completed' != "Don't know")

second$'Highest year of school completed' <- as.numeric(second$'Highest year of school completed')
strongRep <- filter(second,second$'Political party affiliation' == 'Strong republican' & second$'Highest year of school completed' >13)

strongDem <- filter(second,second$'Political party affiliation' == 'Strong democrat' & second$'Highest year of school completed' >12)

other <- filter(second,second$'Political party affiliation' == 'Other party' & second$'Highest year of school completed' >13)

notStrRep <- filter(second,second$'Political party affiliation' == 'Not str republican' & second$'Highest year of school completed' >13)

notStrDem <- filter(second,second$'Political party affiliation' == 'Not str democrat' & second$'Highest year of school completed' >12)

no <- filter(second,second$'Political party affiliation' == 'No answer' & second$'Highest year of school completed' >12)

independent <- filter(second,second$'Political party affiliation' == 'Independent' & second$'Highest year of school completed' >12)
inrep <- filter(second,second$'Political party affiliation' == 'Ind,near rep' & second$'Highest year of school completed' >13)

indem <- filter(second,second$'Political party affiliation' == 'Ind,near dem' & second$'Highest year of school completed' >13)

know <- filter(second,second$'Political party affiliation' == "Don't know" & second$'Highest year of school completed' >11)

betterEduacatied <- rbind(strongRep,strongDem)
betterEduacatied <- rbind(betterEduacatied,other)
betterEduacatied <- rbind(betterEduacatied,notStrRep)
betterEduacatied <- rbind(betterEduacatied,notStrDem)
betterEduacatied <- rbind(betterEduacatied,independent)
betterEduacatied <- rbind(betterEduacatied,inrep)
betterEduacatied <- rbind(betterEduacatied,indem)
betterEduacatied <- rbind(betterEduacatied,know)

betterEduacatied

```
##colin

## Question 3
##allan 
```{r}
marriage <- dat[c('General happiness','Marital status','Political party affiliation')]
marriage <- filter(marriage, marriage$'General happiness' == 'Very happy' | marriage$'General happiness' == 'Pretty happy' | marriage$'General happiness' == 'Not too happy')
marriage <-
marriage <- table(marriage)
marriage <- as.data.frame(marriage)

ggplot(marriage, aes(x=Marital.status, y=Freq)) + geom_bar(aes(fill = General.happiness),stat = "identity",position = "dodge")+coord_flip()
```

3. By the look of the visual and numerically. THe overall person is happy no matter their martial status, but Looking at the married group there are a lot more people that are happy than any other group. In the numerical representation you can see more people are happy across all group, but visually you can see that a lot of people responded to being married and that they were happy.

##colin

## Question 4
##allan 
```{r}

partyMarriage <- dat[c('General happiness','Marital status','Political party affiliation')]
partyMarriage <- filter(partyMarriage, partyMarriage$'General happiness' == 'Very happy' | partyMarriage$'General happiness' == 'Pretty happy' | partyMarriage$'General happiness' == 'Not too happy') 

partyMarriage <- filter(partyMarriage, partyMarriage$'Political party affiliation' != "Don't know" | partyMarriage$'Political party affiliation' != "No answer")

ggplot(partyMarriage, aes(partyMarriage$'Marital status', fill =partyMarriage$'General happiness' ))+ geom_bar(position = "dodge")+ facet_wrap(~partyMarriage$'Political party affiliation') +coord_flip()
```

4. Looking at this there doesnt seem to be a trend between martial status and political party they are all very simlar.
##colin

## Question 5
##allan 
```{r}
happy <- dat[c('Marital status','Highest year of school completed')]  

happy <- filter(happy, happy$'Highest year of school completed' != 'No answer')
happy <- filter(happy, happy$'Highest year of school completed' != "Don't know")
happy <- filter(happy, happy$'Marital status' != "No answer")
happy$'Highest year of school completed' <- as.numeric(happy$'Highest year of school completed')
happy <- aggregate(happy$'Highest year of school completed',list(happy$'Marital status'), FUN = mean)
happy <- happy %>% rename(party = Group.1, years = x)
happy
 
ggplot(happy, aes(x=party, y=years)) + geom_bar(stat = "identity")+coord_flip()
```

5. all the statuses are pretty similar id say there is at least a visual difference on widowed and separated apart from the rest of the groups. Numerically widowed is the lowest with 11 and divorced, married and never is hovering around 13.
##colin

## Question 6: Children, Religion and Self-employed

## Children

```{r}
childrenHappiness <- dat %>% select(Happiness, Children) %>% 
  drop_na %>%
  filter(Happiness != "Don't know" & Happiness != "No answer" & 
           Happiness != 'Not applicable') %>%
  mutate(Children = factor(Children, levels = c(0, 1, 2, 3, 4, 5, 6, 7))) %>%
  arrange(Children) 
ggplot(childrenHappiness, aes(x=Children, fill=Happiness)) + geom_bar(position = 'fill') + ggtitle("Children vs Happiness")
```
First step I took was looking at the number of children vs Happiness but that turned up nothing remarkable like I was expecting. My hypothesis was that their would be a number that had more happiness to be considered the "ideal" number of children but that was not the case. It is all fairly even. So next I looked at the religoin of the respondent versus children to see if there was trend in the amount of kids per religion.

```{r}
temp <- dat %>% select(Religion) %>% unique
religionLevels <- c('Protestant', 'Catholic', 'Other', 'Jewish', 'Christian', 'Inter-nondenominational', 'Hinduism', 'Buddhism', 'Orthodox-christian', 'Moslem/islam', 'Other eastern', 'Native american')
childrenHappiness <- dat %>% select(Religion, Children) %>% 
  drop_na %>%
  filter(Religion != "Don't know" & Religion != "No answer" & 
           Religion != 'Not applicable') %>%
  mutate(Religion = factor(Religion, levels = religionLevels)) %>%
  arrange(Religion) 
ggplot(childrenHappiness, aes(x=Religion, y=Children)) + geom_boxplot() + theme(axis.text.x=element_text(angle=90))+ ggtitle("#Children vs Religoin")
```
The above graph shows that there is some differences with Catholics, Protestants, and Jewish respondents had the highest average and the middle chunk of religions, Christian, Inter-nondenominational, Hinduism, Buddhism and Orthodox-christian all were relatively the same. Protestant was the only, large religion, that had the range from the first quartile to third quartile not resting on 0 for number of children.

## Religion

## Self-Employed
```{r}
employed <-dat %>% select(Happiness, Self.Emp) %>% drop_na   
employed <- filter(employed, employed$Happiness == 'Very happy' | employed$Happiness == 'Pretty happy' | employed$Happiness == 'Not too happy')
employed <- filter(employed, employed$Self.Emp != 'No answer' )
employed <- filter(employed, employed$Self.Emp != 'Not applicable')
 employed <- filter(employed,employed$Self.Emp != "Don't know" )
employed <- table(employed)
employed <- as.data.frame(employed)
ggplot(employed, aes(x=Self.Emp, y=Freq)) + geom_bar(aes(fill = Happiness),stat = "identity",position = "dodge")+coord_flip()
```

6. For individual we compared the happiness on the person and checked if they were unemployed or not. There didnt really seem to be any trend between them. The only real difference was the percentage of people not happy between the two. If you were employed by someone else 15 percent of people reported to be unhappy vs the 12 percent of people that were unhappy and self employed.

