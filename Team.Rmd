---
title: "Team"
author: "Colin Willenborg, Allan Juarez, Adam Brandt"
date: "9/23/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
dat <- readxl::read_xls('./GSS.xls')
dat <- dat %>%
  rename(
    Year = 'Gss year for this respondent',
    Happiness = 'General happiness',
    Religion = 'Religion in which raised',
    Political.Party = 'Political party affiliation',
    Sex = 'Respondents sex',
    Degree = 'Rs highest degree',
    Year.School = 'Highest year of school completed',
    Children = 'Number of children',
    Marital.Status = 'Marital status',
    Self.Emp = 'R self-emp or works for somebody',
    ID = 'Respondent id number',
    Ballot = 'Ballot used for interview'
  )
dat$Children <- as.numeric(dat$Children)
dat$Year.School <- as.numeric(dat$Year.School)
```

## Question 1

## Question 2

## Question 3

## Question 4

## Question 5

## Question 6: Children, Religion and Self-employed

## Children

```{r}
childrenHappiness <- dat %>% select(Happiness, Children) %>% 
  drop_na %>%
  filter(Happiness != "Don't know" & Happiness != "No answer" & 
           Happiness != 'Not applicable') %>%
  mutate(Children = factor(Children, levels = c(0, 1, 2, 3, 4, 5, 6, 7))) %>%
  arrange(Children) 
ggplot(childrenHappiness, aes(x=Children, fill=Happiness)) + geom_bar(position = 'fill') + ggtitle("Children vs Happiness")
```
First step I took was looking at the number of children vs Happiness but that turned up nothing remarkable like I was expecting. My hypothesis was that their would be a number that had more happiness to be considered the "ideal" number of children but that was not the case. It is all fairly even. So next I looked at the religoin of the respondent versus children to see if there was trend in the amount of kids per religion.

```{r}
temp <- dat %>% select(Religion) %>% unique
religionLevels <- c('Protestant', 'Catholic', 'Other', 'Jewish', 'Christian', 'Inter-nondenominational', 'Hinduism', 'Buddhism', 'Orthodox-christian', 'Moslem/islam', 'Other eastern', 'Native american')
childrenHappiness <- dat %>% select(Religion, Children) %>% 
  drop_na %>%
  filter(Religion != "Don't know" & Religion != "No answer" & 
           Religion != 'Not applicable') %>%
  mutate(Religion = factor(Religion, levels = religionLevels)) %>%
  arrange(Religion) 
ggplot(childrenHappiness, aes(x=Religion, y=Children)) + geom_boxplot() + theme(axis.text.x=element_text(angle=90))+ ggtitle("#Children vs Religoin")
```
The above graph shows that there is some differences with Catholics, Protestants, and Jewish respondents had the highest average and the middle chunk of religions, Christian, Inter-nondenominational, Hinduism, Buddhism and Orthodox-christian all were relatively the same. Protestant was the only, large religion, that had the range from the first quartile to third quartile not resting on 0 for number of children.

## Religion

## Self-Employed
```{r}
employed <-dat %>% select(Happiness, Self.Emp) %>% drop_na   
employed <- filter(employed, employed$Happiness == 'Very happy' | employed$Happiness == 'Pretty happy' | employed$Happiness == 'Not too happy')
employed <- filter(employed, employed$Self.Emp != 'No answer' )
employed <- filter(employed, employed$Self.Emp != 'Not applicable')
 employed <- filter(employed,employed$Self.Emp != "Don't know" )
employed <- table(employed)
employed <- as.data.frame(employed)
ggplot(employed, aes(x=Self.Emp, y=Freq)) + geom_bar(aes(fill = Happiness),stat = "identity",position = "dodge")+coord_flip()
```
6. For individual we compared the happiness on the person and checked if they were unemployed or not. There didnt really seem to be any trend between them. The only real difference was the percentage of people not happy between the two. If you were employed by someone else 15 percent of people reported to be unhappy vs the 12 percent of people that were unhappy and self employed.

